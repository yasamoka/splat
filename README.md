# Splat

A mini-set of easy-to-use methods for hashing, validating, and joining split file chunks

## Requirements

Requires Python 3. Tested on Python 3.6.6.

## Usage Examples

Split files are usually generated by the Linux "split" command:
```
split --bytes=10M file.ext chunks/file_chunk
```

Assuming {file.ext} was 1GB, the "split" command would produce 100 chunks with the suffixes "aa" to "dw" (file_chunkaa -> file_chunkww).

To hash (SHA-1) the produced chunks and produce an info JSON file containing the hashes:
```
>>> import splat
>>> splat.hash("file_chunk", end_suffix="dw")
```

To specify the info JSON filepath and turn off verbosity:
```
>>> splat.hash("file_chunk", end_suffix="dw", json_filepath="file_info.json", verbose=False)
```

If the splitter you have used starts at a different suffix but follows an ascending pattern similar to "split", you can also specify the starting suffix:
```
>>> splat.hash("file_chunk", end_suffix="dy", start_suffix="ac")
```

To validate the received chunks against the hashes contained in the info JSON file:
```
>>> import splat
>>> splat.validate("file_chunk")
```

Similarly, to specify the info JSON filepath and turn off verbosity:
```
>>> splat.validate("file_chunk", json_filepath="file_info.json", verbose=False)
```

You can, in a similar fashion, specify the starting suffix if need be.

Mismatches are returned in the form of a dictionary with the mismatching chunks as keys and 2-tuples containing the actual and expected hash hex digests as values.

If verbosity is enabled, mismatches are reported in real-time.

You can have the validation method stop at the first mismatch:
```
splat.validate("file_chunk", stop_at_mismatch=True)
```

To join the received chunks:
```
>>> import splat
>>> splat.join("file_chunk", "file.ext")
```

Similarly, to specify the info JSON filepath and turn off verbosity:
```
>>> splat.join("file_chunk", "file.ext", json_filepath="file_info.json", verbose=False)
```

To enable hashing as a safety measure (albeit with a potentially visible performance hit) while joining:
```
>>> splat.join("file_chunk", "file.ext", hash=True)
```

Joining would stop at the first mismatch detected.

## Complete Example

At the splitting end, splitting a 2GB file named "download.bin" into 10MB chunks:
```
mkdir chunks
split --bytes=10M download.bin chunks/download_chunk_
```

200 chunks starting with "download_chunk_aa" and ending with "download_chunk_hs" are created.

Hashing the chunks:
```
cd chunks
python3
>>> import splat
>>> splat.hash("download_chunk_", end_suffix="hs")
```

After having downloaded the chunks on the receiving end, copy the produced "info.json" file from the splitting end to the same folder containing the received chunks.

To validate the chunks:
```
cd {downloaded chunks path}
python3
>>> import splat
>>> splat.validate("download_chunk_")
```

If validation fails at particular chunks, redownload those chunks and re-validate.

If validation passes, then to join the chunks:
```
>>> splat.join("download_chunk_", "download.bin")
```